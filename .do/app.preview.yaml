alerts:
- rule: DEPLOYMENT_FAILED
- rule: DOMAIN_FAILED
features:
- buildpack-stack=ubuntu-22
ingress:
  rules:
  - component:
      name: cogni-git-review-preview
    match:
      authority:
        exact: ""
      path:
        prefix: /cogni-git-review-preview
name: cogni-git-review-preview
region: atl
services:
- build_command: npm ci
  environment_slug: node-js
  envs:
  - key: NODE_ENV
    scope: RUN_TIME
    value: production
  - key: APP_ENV
    scope: RUN_TIME
    value: preview
  - key: APP_ID
    scope: RUN_TIME
    value: ${APP_ID}
  - key: OPENAI_API_KEY
    scope: RUN_TIME
    type: SECRET
    value: ${OPENAI_API_KEY}
  - key: PRIVATE_KEY
    scope: RUN_TIME
    type: SECRET
    value: ${PRIVATE_KEY}
  - key: WEBHOOK_SECRET_GITHUB
    scope: RUN_TIME
    type: SECRET
    value: ${WEBHOOK_SECRET_GITHUB}
  - key: WEBHOOK_SECRET_GITLAB
    scope: RUN_TIME
    type: SECRET
    value: ${WEBHOOK_SECRET_GITLAB}
  - key: LANGFUSE_PUBLIC_KEY
    scope: RUN_TIME
    type: SECRET
    value: ${LANGFUSE_PUBLIC_KEY}
  - key: LANGFUSE_SECRET_KEY
    scope: RUN_TIME
    type: SECRET
    value: ${LANGFUSE_SECRET_KEY}
  - key: LANGFUSE_BASE_URL
    scope: RUN_TIME
    type: SECRET
    value: ${LANGFUSE_BASE_URL}
  - key: LOKI_URL
    scope: RUN_TIME
    value: ${LOKI_URL}
  - key: LOKI_USER
    scope: RUN_TIME
    type: SECRET
    value: ${LOKI_USER}
  - key: LOKI_TOKEN
    scope: RUN_TIME
    type: SECRET
    value: ${LOKI_TOKEN}
  github:
    branch: main
    repo: Cogni-DAO/cogni-git-review
  http_port: 3000
  instance_count: 1
  instance_size_slug: apps-s-1vcpu-0.5gb
  name: cogni-git-review-preview
  run_command: npm start
  source_dir: /
